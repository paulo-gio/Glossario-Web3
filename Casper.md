# Casper (Casper-FFG, Casper the Friendly Finality Gadget) 

>"*O Casper é um sistema de consenso que utiliza a Prova de Participação (PoS) em conjunto com uma blockchain baseada em Prova de Trabalho (PoW). Ele visa oferecer proteções adicionais contra a reversão de blocos em cadeias PoW. No Casper, os detentores de moedas podem participar e influenciar a adição de novos blocos com base na quantidade de moedas que possuem em stake. O sistema segue a abordagem baseada em tolerância a falhas bizantinas (BFT) e é responsável por finalizar blocos propostos, escolhendo a cadeia canônica que representa as transações do livro-razão.*"

O Casper é um sistema de consenso baseado em Prova de Participação (PoS), que se sobrepõe a uma blockchain baseada em Prova de Trabalho (PoW). Esse mecanismo foi introduzido para oferecer proteções adicionais contra a reversão de blocos em praticamente qualquer cadeia de Prova de Trabalho.

A Prova de Participação representa uma alternativa mais eficiente à mineração da Prova de Trabalho, permitindo que as blockchains operem sem os altos custos de hardware e energia elétrica. No sistema PoS, os novos blocos são adicionados e aceitos através de um processo no qual qualquer um que detenha moedas dentro do sistema pode participar, sendo a influência de um agente proporcional ao número de moedas em stake, ou "participação", que ele possui.

Existem duas principais escolas de pensamento no design da PoS: a baseada em cadeia, que imita os mecanismos da Prova de Trabalho e simula a mineração atribuindo aleatoriamente o direito de criar novos blocos aos detentores de participação; e a baseada em tolerância a falhas bizantinas (BFT), que se fundamenta em três décadas de pesquisa em algoritmos de consenso BFT. O Casper segue esta última linha de pensamento, mas com algumas modificações.

Casper, apelidado de "Gadget de Finalidade Amigável", é uma sobreposição no topo de um mecanismo de proposta, que propõe blocos. O papel do Casper é finalizar esses blocos, essencialmente selecionando uma única cadeia que representa as transações canônicas do livro-razão. Embora o Casper forneça segurança, a vitalidade depende do mecanismo de proposta escolhido.

Esse sistema introduz várias novas características, como responsabilização (se um validador violar uma regra, é possível detectar a violação e saber qual validador a cometeu), validadores dinâmicos (o Casper apresenta uma maneira segura de alterar o conjunto de validadores ao longo do tempo), defesas contra ataques de revisão de longo alcance e ataques em que mais de um terço dos validadores estão inoperantes, e uma sobreposição modular (o design do Casper como uma sobreposição facilita a sua implementação como uma atualização para uma cadeia de prova de trabalho existente).

Na plataforma Ethereum, a cadeia de PoW existente atuou como o mecanismo de proposta inicial, resultando na primeira versão do Casper sendo um sistema híbrido de Prova de Trabalho/Prova de Participação (PoW/PoS). Em versões futuras, o mecanismo de proposta PoW foi substituído pelo Gasper, que é uma combinação do Casper e do algoritmo GHOST.

No Casper simplificado, pressupõe-se que existe um conjunto fixo de validadores e um mecanismo de proposta que produz blocos filhos a partir de blocos existentes, formando uma árvore de blocos em constante crescimento. O Casper seleciona um único filho de cada pai, escolhendo assim uma cadeia canônica da árvore de blocos.

Cada validador tem um depósito; ao ingressar, o depósito é o número de moedas depositadas. Com o tempo, o depósito de cada validador aumenta e diminui com as recompensas e penalidades. A segurança da Prova de Participação deriva do tamanho dos depósitos, não do número de validadores.

O Casper apresenta extensões para se defender contra dois ataques comuns. No entanto, o sistema ainda é imperfeito. Por exemplo, um mecanismo de proposta de bloco totalmente comprometido impedirá o Casper de finalizar novos blocos. Mesmo com estas limitações, o Casper representa uma melhoria significativa na segurança baseada em PoS para quase qualquer cadeia de PoW. As questões que o Casper ainda não resolve totalmente, em particular relacionadas aos ataques de 51%, ainda podem ser mitigadas usando soft forks ativados pelo usuário. Desenvolvimentos futuros, sem dúvida, irão aumentar a segurança do Casper e reduzir a necessidade de soft forks ativados pelo usuário.
